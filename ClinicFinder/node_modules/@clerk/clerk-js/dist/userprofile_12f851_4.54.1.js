"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[971],{4781:function(e,t,i){i.d(t,{v:function(){return o}});const o=({signUp:e,verifyEmailPath:t,verifyPhonePath:i,navigate:o,handleComplete:r,redirectUrl:a="",redirectUrlComplete:l=""})=>{var n,s;if("complete"===e.status)return r&&r();if("missing_requirements"===e.status){if(e.missingFields.some((e=>"saml"===e)))return e.authenticateWithRedirect({strategy:"saml",redirectUrl:a,redirectUrlComplete:l,continueSignUp:!0});if((null===(n=e.unverifiedFields)||void 0===n?void 0:n.includes("email_address"))&&t)return o(t);if((null===(s=e.unverifiedFields)||void 0===s?void 0:s.includes("phone_number"))&&i)return o(i)}}},4166:function(e,t,i){i.d(t,{B:function(){return s},o:function(){return n}});var o=i(2903),r=i(3476),a=i(5064),l=i(3033);const n=e=>(0,o.tZ)(a.ArrowBlockButton,{variant:"ghost",...e}),s=e=>{var t;const{id:i,leftIcon:a,...s}=e;return(0,o.tZ)(n,{elementDescriptor:r.descriptors.profileSectionPrimaryButton,elementId:null===(t=r.descriptors.profileSectionPrimaryButton)||void 0===t?void 0:t.setId(i),colorScheme:"primary",...s,sx:e=>({justifyContent:"flex-start",gap:e.space.$2}),leftIcon:(0,o.tZ)(r.Icon,{icon:a||l.v3,sx:e=>({width:e.sizes.$2x5,height:e.sizes.$2x5})}),children:e.children})}},9093:function(e,t,i){i.d(t,{Y:function(){return s},_:function(){return u}});var o=i(2903),r=(i(2784),i(5064)),a=i(3033),l=i(4334);const n=[{name:(0,l.u1)("userProfile.start.headerTitle__account"),id:"account",icon:a.n5,path:"/"},{name:(0,l.u1)("userProfile.start.headerTitle__security"),id:"security",icon:a.qy,path:""}],s=e=>(0,o.BX)(r.NavbarContextProvider,{children:[(0,o.tZ)(r.NavBar,{routes:n,contentRef:e.contentRef}),e.children]}),c={profile:n.find((e=>"account"===e.id)),"email-address":n.find((e=>"account"===e.id)),"phone-number":n.find((e=>"account"===e.id)),"connected-account":n.find((e=>"account"===e.id)),"web3-wallet":n.find((e=>"account"===e.id)),username:n.find((e=>"account"===e.id)),"multi-factor":n.find((e=>"security"===e.id)),password:n.find((e=>"security"===e.id))},u=e=>(0,o.tZ)(r.Breadcrumbs,{...e,pageToRootNavbarRoute:c})},5979:function(e,t,i){i.r(t),i.d(t,{UserProfile:function(){return Ue},UserProfileModal:function(){return Xe}});var o=i(2903),r=i(2784),a=i(8147),l=i(2425),n=i(3476),s=i(5064),c=i(3736),u=i(9093),d=i(3979),m=i(8251),f=i(7135);const p=(0,s.withCardStateProvider)((()=>{const e=(0,n.localizationKeys)("userProfile.connectedAccountPage.title"),t=(0,l.useCoreUser)(),{params:i}=(0,c.useRouter)(),{id:d}=i||{},m=r.useRef(t.externalAccounts.find((e=>e.id===d))),f=(0,a.a2)({defaultStep:m.current?1:0});return(0,o.BX)(a.en,{...f.props,children:[(0,o.tZ)(h,{}),(0,o.tZ)(s.SuccessPage,{title:e,text:(0,n.localizationKeys)("userProfile.connectedAccountPage.successMessage"),Breadcrumbs:u._})]})})),h=()=>{const e=(0,s.useCardState)(),t=(0,l.useCoreUser)(),{navigate:i}=(0,c.useRouter)(),{strategies:r,strategyToDisplayData:a}=(0,m.vO)(),{additionalOAuthScopes:u,componentName:p,mode:h}=(0,l.useUserProfileContext)(),P="modal"===h,g=r.filter((e=>e.startsWith("oauth"))),y=t.verifiedExternalAccounts.map((e=>"oauth_"+e.provider)),v=g.filter((e=>!y.includes(e)));return(0,o.BX)(s.ContentPage,{headerTitle:(0,n.localizationKeys)("userProfile.connectedAccountPage.title"),children:[(0,o.tZ)(n.Text,{localizationKey:v.length?(0,n.localizationKeys)("userProfile.connectedAccountPage.formHint"):(0,n.localizationKeys)("userProfile.connectedAccountPage.formHint__noAccounts")}),(0,o.tZ)(n.Col,{gap:2,children:v.map((r=>(0,o.tZ)(s.ArrowBlockButton,{id:a[r].id,onClick:()=>(o=>{const r=o.replace("oauth_",""),a=P?(0,d.bX)({url:window.location.href,componentName:p,socialProvider:r}):window.location.href,l=u?u[r]:[];e.setLoading(o),t.createExternalAccount({strategy:o,redirectUrl:a,additionalScopes:l}).then((e=>{var t;(null===(t=e.verification)||void 0===t?void 0:t.externalVerificationRedirectURL)&&i(e.verification.externalVerificationRedirectURL.href)})).catch((t=>(0,f.S3)(t,[],e.setError))).finally((()=>{(0,f._v)(2e3).then((()=>e.setIdle))}))})(r),isLoading:e.loadingMetadata===r,isDisabled:e.isLoading,leftIcon:(0,o.tZ)(n.Image,{isLoading:e.loadingMetadata===r,isDisabled:e.isLoading,src:a[r].iconUrl,alt:`Connect ${a[r].name} account`,sx:e=>({width:e.sizes.$5})}),textLocalizationKey:(0,n.localizationKeys)("userProfile.connectedAccountPage.socialButtonsBlockButton",{provider:a[r].name})},r)))}),(0,o.tZ)(s.FormButtonContainer,{sx:{marginTop:0},children:(0,o.tZ)(s.NavigateToFlowStartButton,{localizationKey:(0,n.localizationKeys)("userProfile.formButtonReset")})})]})},P=e=>(t,i)=>e===t.id?-1:e===i.id?1:0,g=e=>e.defaultSecondFactor?-1:1;function y(e){const t=[];return Object.entries(e).forEach((([,e])=>{e.used_for_second_factor&&t.push(...e.second_factors)})),t}function v(e,t){let i=y(e);return t.totpEnabled&&(i=i.filter((e=>"totp"!==e))),!t.backupCodeEnabled&&t.twoFactorEnabled||(i=i.filter((e=>"backup_code"!==e))),i}var b=i(6684);const S=e=>{const t=(0,s.useCardState)(),{nextStep:i,identification:a,identifier:l,prepareVerification:c}=e,[u,d]=r.useState(!1),p=(0,m._m)(),h=(0,f.Yp)("code",""),P=(0,s.useCodeControl)(h);r.useEffect((()=>{g()}),[]);const g=()=>{var e;return null===(e=null==c?void 0:c())||void 0===e?void 0:e.catch((e=>(0,f.S3)(e,[],t.setError)))},y=async e=>{(0,f.S3)(e,[h],t.setError),p.setIdle(),await(0,f._v)(750),P.reset()};return P.onCodeEntryFinished((e=>(p.setLoading(),h.setError(void 0),null==a?void 0:a.attemptVerification({code:e}).then((()=>(async()=>{d(!0),await(0,f._v)(750),i()})())).catch(y)))),(0,o.BX)(o.HY,{children:[(0,o.tZ)(b.T,{title:(0,n.localizationKeys)("userProfile.emailAddressPage.emailCode.formTitle"),subtitle:(0,n.localizationKeys)("userProfile.emailAddressPage.emailCode.formSubtitle",{identifier:l}),resendButton:(0,n.localizationKeys)("userProfile.emailAddressPage.emailCode.resendButton"),codeControl:P,isLoading:p.isLoading,success:u,onResendCodeClicked:g}),(0,o.tZ)(s.FormButtonContainer,{children:(0,o.tZ)(s.NavigateToFlowStartButton,{localizationKey:(0,n.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:n.descriptors.formButtonReset})})]})};var z=i(6874);const Z=e=>{const{email:t,nextStep:i}=e,a=(0,s.useCardState)(),c=(0,l.useUserProfileContext)(),{startMagicLinkFlow:u}=(0,m.jS)(t),{displayConfig:d}=(0,l.useEnvironment)();function p(){const{routing:e}=c,t="virtual"===e?d.userProfileUrl:"",o=(0,z.V)(c,t);u({redirectUrl:o}).then((()=>i())).catch((e=>(0,f.S3)(e,[],a.setError)))}return r.useEffect((()=>{p()}),[]),(0,o.BX)(o.HY,{children:[(0,o.tZ)(s.VerificationLink,{formTitle:(0,n.localizationKeys)("userProfile.emailAddressPage.emailLink.formTitle"),formSubtitle:(0,n.localizationKeys)("userProfile.emailAddressPage.emailLink.formSubtitle",{identifier:t.emailAddress}),resendButton:(0,n.localizationKeys)("userProfile.emailAddressPage.emailLink.resendButton"),onResendCodeClicked:p}),(0,o.tZ)(s.FormButtonContainer,{children:(0,o.tZ)(s.NavigateToFlowStartButton,{localizationKey:(0,n.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:n.descriptors.formButtonReset})})]})},C=()=>(0,o.tZ)(a.Ej,{title:(0,n.localizationKeys)("signUp.emailLink.verifiedSwitchTab.title"),subtitle:(0,n.localizationKeys)("signUp.emailLink.verifiedSwitchTab.subtitle"),status:"verified"}),K=(0,s.withCardStateProvider)((()=>{var e,t,i;const d=(0,n.localizationKeys)("userProfile.emailAddressPage.title"),m=(0,s.useCardState)(),p=(0,l.useCoreUser)(),h=function(e){const{userSettings:t}=e,{email_address:i}=t.attributes;return i.enabled&&i.verifications.includes("email_link")}((0,l.useEnvironment)()),{params:P}=(0,c.useRouter)(),{id:g}=P||{},y=r.useRef(p.emailAddresses.find((e=>e.id===g))),v=(0,a.a2)({defaultStep:y.current?1:0,onNextStep:()=>m.setError(void 0)}),b=(0,f.Yp)("emailAddress","",{type:"text",label:(0,n.localizationKeys)("formFieldLabel__emailAddress"),placeholder:(0,n.localizationKeys)("formFieldInputPlaceholder__emailAddress"),isRequired:!0}),z=b.value.length>1&&p.username!==b.value;return(0,o.BX)(a.en,{...v.props,children:[(0,o.tZ)(s.ContentPage,{headerTitle:d,children:(0,o.BX)(s.Form.Root,{onSubmit:async e=>(e.preventDefault(),p.createEmailAddress({email:b.value}).then((e=>{y.current=e,v.nextStep()})).catch((e=>(0,f.S3)(e,[b],m.setError)))),children:[(0,o.tZ)(s.Form.ControlRow,{elementId:b.id,children:(0,o.tZ)(s.Form.Control,{...b.props,required:!0,autoFocus:!0})}),(0,o.tZ)(n.Text,{localizationKey:h?(0,n.localizationKeys)("userProfile.emailAddressPage.emailLink.formHint"):(0,n.localizationKeys)("userProfile.emailAddressPage.emailCode.formHint"),variant:"regularRegular"}),(0,o.tZ)(s.FormButtons,{isDisabled:!z})]})}),(0,o.tZ)(s.ContentPage,{headerTitle:d,children:h?(0,o.tZ)(Z,{nextStep:v.nextStep,email:y.current}):(0,o.tZ)(S,{nextStep:v.nextStep,identification:y.current,identifier:null===(e=y.current)||void 0===e?void 0:e.emailAddress,prepareVerification:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.prepareVerification({strategy:"email_code"})}})}),(0,o.tZ)(s.SuccessPage,{title:d,text:h?(0,n.localizationKeys)("userProfile.emailAddressPage.emailLink.successMessage",{identifier:(null===(t=y.current)||void 0===t?void 0:t.emailAddress)||""}):(0,n.localizationKeys)("userProfile.emailAddressPage.emailCode.successMessage",{identifier:(null===(i=y.current)||void 0===i?void 0:i.emailAddress)||""}),Breadcrumbs:u._})]})}));var _=i(4016),B=i(9820);const w=e=>{const{code:t}=e;return(0,o.tZ)(n.Flex,{center:!0,sx:e=>({backgroundColor:e.colors.$blackAlpha50,padding:`${e.space.$1} ${e.space.$4}`,borderRadius:e.radii.$sm}),children:(0,o.tZ)(n.Text,{children:t})})},R=e=>{const{subtitle:t,backupCodes:i}=e,{applicationName:r}=(0,l.useEnvironment)().displayConfig,s=(0,l.useCoreUser)(),{print:c,printableProps:u}=(0,a.Qz)(),{onCopy:d,hasCopied:f}=(0,m.VP)((null==i?void 0:i.join(","))||""),p=(0,_.xC)(s);return i?(0,o.BX)(o.HY,{children:[(0,o.BX)(n.Col,{gap:1,children:[(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.backupCodePage.title__codelist"),variant:"regularMedium"}),(0,o.tZ)(n.Text,{localizationKey:t,variant:"smallRegular",colorScheme:"neutral"})]}),(0,o.tZ)(n.Grid,{gap:2,sx:e=>({gridTemplateColumns:`repeat(5, minmax(${e.sizes.$12}, 1fr))`,[B.mqu.sm]:{gridTemplateColumns:`repeat(2, minmax(${e.sizes.$12}, 1fr))`}}),children:i.map(((e,t)=>(0,o.tZ)(w,{code:e},t)))}),(0,o.BX)(n.Flex,{gap:6,children:[(0,o.tZ)(n.Button,{variant:"link",colorScheme:"primary",onClick:d,localizationKey:f?(0,n.localizationKeys)("userProfile.backupCodePage.actionLabel__copied"):(0,n.localizationKeys)("userProfile.backupCodePage.actionLabel__copy")}),(0,o.tZ)(n.Button,{variant:"link",colorScheme:"primary",onClick:()=>{const e=document.createElement("a"),t=new Blob([T(i,r,p)],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download=`${r}_backup_codes.txt`,document.body.appendChild(e),e.click()},localizationKey:(0,n.localizationKeys)("userProfile.backupCodePage.actionLabel__download")}),(0,o.tZ)(n.Button,{variant:"link",colorScheme:"primary",onClick:c,localizationKey:(0,n.localizationKeys)("userProfile.backupCodePage.actionLabel__print")})]}),(0,o.BX)(a.o4,{...u,children:[(0,o.BX)(n.Heading,{children:["Your backup codes for ",r," account ",p,":"]}),(0,o.tZ)(n.Col,{gap:2,children:i.map(((e,t)=>(0,o.tZ)(w,{code:e},t)))})]})]}):null};function T(e,t,i){return`These are your backup codes for ${t} account ${i}.\nStore them securely and keep them secret. Each code can only be used once.\n\n${null==e?void 0:e.join("\n")}`}const x=(0,s.withCardStateProvider)((()=>{const e=(0,l.useCoreUser)(),t=(0,s.useCardState)(),[i,a]=r.useState(void 0);return r.useEffect((()=>{i||e.createBackupCode().then((e=>a(e))).catch((e=>(0,f.S3)(e,[],t.setError)))}),[]),t.error?(0,o.tZ)(s.ContentPage,{headerTitle:(0,n.localizationKeys)("userProfile.backupCodePage.title"),Breadcrumbs:u._}):(0,o.tZ)(s.ContentPage,{headerTitle:(0,n.localizationKeys)("userProfile.backupCodePage.title"),Breadcrumbs:u._,children:i?(0,o.BX)(o.HY,{children:[(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.backupCodePage.successMessage"),variant:"regularRegular"}),(0,o.tZ)(R,{subtitle:(0,n.localizationKeys)("userProfile.backupCodePage.subtitle__codelist"),backupCodes:i.codes}),(0,o.tZ)(s.FormButtonContainer,{children:(0,o.tZ)(s.NavigateToFlowStartButton,{variant:"solid",autoFocus:!0,localizationKey:(0,n.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:n.descriptors.formButtonPrimary})})]}):(0,o.tZ)(s.FullHeightLoader,{})})}));var A=i(3033);const k=(0,s.withCardStateProvider)((()=>{const e=(0,a.a2)();return(0,o.BX)(a.en,{...e.props,children:[(0,o.tZ)(L,{onContinue:e.nextStep}),(0,o.tZ)(x,{})]})})),L=e=>{const{onContinue:t}=e;return(0,o.BX)(s.ContentPage,{headerTitle:(0,n.localizationKeys)("userProfile.backupCodePage.title"),Breadcrumbs:u._,children:[(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.backupCodePage.infoText1")}),(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.backupCodePage.infoText2")}),(0,o.BX)(s.FormButtonContainer,{sx:{marginTop:0},children:[(0,o.tZ)(n.Button,{textVariant:"buttonExtraSmallBold",onClick:t,localizationKey:(0,n.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:n.descriptors.formButtonPrimary}),(0,o.tZ)(s.NavigateToFlowStartButton,{localizationKey:(0,n.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:n.descriptors.formButtonReset})]})]})},F=(0,s.withCardStateProvider)((()=>{var e;const t=(0,l.useCoreUser)(),{params:i}=(0,c.useRouter)(),{id:d}=i||{},m=r.useRef(t.phoneNumbers.find((e=>e.id===d))),f=(0,a.a2)({defaultStep:m.current?1:0});return(0,o.BX)(a.en,{...f.props,children:[(0,o.tZ)(N,{resourceRef:m,title:(0,n.localizationKeys)("userProfile.phoneNumberPage.title"),onSuccess:f.nextStep}),(0,o.tZ)(U,{resourceRef:m,title:(0,n.localizationKeys)("userProfile.phoneNumberPage.title"),onSuccess:f.nextStep}),(0,o.tZ)(s.SuccessPage,{title:(0,n.localizationKeys)("userProfile.phoneNumberPage.title"),text:(0,n.localizationKeys)("userProfile.phoneNumberPage.successMessage",{identifier:(null===(e=m.current)||void 0===e?void 0:e.phoneNumber)||""}),Breadcrumbs:u._})]})})),N=e=>{const{title:t,onSuccess:i,resourceRef:r}=e,a=(0,s.useCardState)(),c=(0,l.useCoreUser)(),d=(0,f.Yp)("phoneNumber","",{type:"tel",label:(0,n.localizationKeys)("formFieldLabel__phoneNumber"),isRequired:!0}),m=d.value.length>1&&c.username!==d.value;return(0,o.tZ)(s.ContentPage,{headerTitle:t,Breadcrumbs:u._,children:(0,o.BX)(s.Form.Root,{onSubmit:async e=>(e.preventDefault(),c.createPhoneNumber({phoneNumber:d.value}).then((e=>{r.current=e,i()})).catch((e=>(0,f.S3)(e,[d],a.setError)))),children:[(0,o.tZ)(s.Form.ControlRow,{elementId:d.id,children:(0,o.tZ)(s.Form.Control,{...d.props,required:!0,autoFocus:!0})}),(0,o.tZ)(n.Text,{variant:"regularRegular",localizationKey:(0,n.localizationKeys)("userProfile.phoneNumberPage.infoText")}),(0,o.tZ)(n.Text,{variant:"smallRegular",colorScheme:"neutral",localizationKey:(0,n.localizationKeys)("userProfile.phoneNumberPage.infoText__secondary")}),(0,o.tZ)(s.FormButtons,{isDisabled:!m})]})})},U=e=>{var t,i;const{title:r,onSuccess:a,resourceRef:l}=e;return(0,o.tZ)(s.ContentPage,{headerTitle:r,Breadcrumbs:u._,children:(0,o.tZ)(S,{nextStep:a,identification:l.current,identifier:null===(t=l.current)||void 0===t?void 0:t.phoneNumber,prepareVerification:null===(i=l.current)||void 0===i?void 0:i.prepareVerification})})};var X=i(4166);const E=(0,s.withCardStateProvider)((()=>{var e;const t=r.useRef(),i=(0,a.a2)({defaultStep:2});return(0,o.BX)(a.en,{...i.props,children:[(0,o.tZ)(N,{title:(0,n.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:t,onSuccess:i.nextStep}),(0,o.tZ)(U,{title:(0,n.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:t,onSuccess:i.nextStep}),(0,o.tZ)(I,{onSuccess:i.nextStep,onAddPhoneClick:()=>i.goToStep(0),onUnverifiedPhoneClick:e=>{t.current=e,i.goToStep(1)},title:(0,n.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:t}),(0,o.tZ)(s.SuccessPage,{title:(0,n.localizationKeys)("userProfile.mfaPhoneCodePage.title"),text:(0,n.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage"),contents:(0,o.tZ)(R,{subtitle:(0,n.localizationKeys)("userProfile.backupCodePage.successSubtitle"),backupCodes:null===(e=t.current)||void 0===e?void 0:e.backupCodes}),Breadcrumbs:u._})]})})),I=e=>{const{onSuccess:t,title:i,onAddPhoneClick:r,onUnverifiedPhoneClick:a,resourceRef:c}=e,d=(0,s.useCardState)(),m=(0,l.useCoreUser)().phoneNumbers.filter((e=>!e.reservedForSecondFactor));return(0,o.BX)(s.ContentPage,{headerTitle:i,Breadcrumbs:u._,children:[(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)(m.length?"userProfile.mfaPhoneCodePage.subtitle__availablePhoneNumbers":"userProfile.mfaPhoneCodePage.subtitle__unavailablePhoneNumbers")}),(0,o.BX)(n.Col,{gap:2,children:[m.map((e=>{const i=(0,f.L_)(e.phoneNumber),r=(0,f.uz)((0,f.y3)(e.phoneNumber).iso);return(0,o.tZ)(s.ArrowBlockButton,{onClick:()=>(e=>{if("verified"!==e.verification.status)return a(e);d.setLoading(e.id),e.setReservedForSecondFactor({reserved:!0}).then((()=>{d.setIdle(),t()})).catch((e=>(0,f.S3)(e,[],d.setError))),c.current=e})(e),isLoading:d.loadingMetadata===e.id,isDisabled:d.isLoading,leftIcon:(0,o.tZ)(n.Text,{as:"span",sx:e=>({fontSize:e.fontSizes.$sm}),children:r}),children:i},e.id)})),(0,o.tZ)(X.B,{block:!1,onClick:r,textLocalizationKey:(0,n.localizationKeys)("userProfile.mfaPhoneCodePage.primaryButton__addPhoneNumber")})]}),(0,o.tZ)(s.FormButtonContainer,{sx:{marginTop:0},children:(0,o.tZ)(s.NavigateToFlowStartButton,{localizationKey:(0,n.localizationKeys)("userProfile.formButtonReset")})})]})},$=e=>{const{title:t,onContinue:i}=e,c=(0,l.useCoreUser)(),d=(0,s.useCardState)(),[m,p]=r.useState(void 0),[h,P]=r.useState("qr");return r.useEffect((()=>{c.createTOTP().then((e=>p(e))).catch((e=>(0,f.S3)(e,[],d.setError)))}),[]),d.error?(0,o.tZ)(s.ContentPage,{headerTitle:t}):(0,o.BX)(s.ContentPage,{headerTitle:t,Breadcrumbs:u._,children:[!m&&(0,o.tZ)(s.FullHeightLoader,{}),m&&(0,o.BX)(o.HY,{children:[(0,o.BX)(n.Col,{gap:4,children:["qr"==h&&(0,o.BX)(o.HY,{children:[(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__ableToScan")}),(0,o.tZ)(a.s_,{url:m.uri||""}),(0,o.tZ)(n.Button,{variant:"link",onClick:()=>P("uri"),localizationKey:(0,n.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonUnableToScan__nonPrimary")})]}),"uri"==h&&(0,o.BX)(o.HY,{children:[(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__unableToScan")}),(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan1")}),(0,o.tZ)(s.ClipboardInput,{value:m.secret}),(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan2")}),(0,o.tZ)(s.ClipboardInput,{value:m.uri}),(0,o.tZ)(n.Button,{variant:"link",onClick:()=>P("qr"),localizationKey:(0,n.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonAbleToScan__nonPrimary")})]})]}),(0,o.BX)(s.FormButtonContainer,{sx:{marginTop:0},children:[(0,o.tZ)(n.Button,{textVariant:"buttonExtraSmallBold",onClick:i,localizationKey:(0,n.localizationKeys)("userProfile.formButtonPrimary__continue"),elementDescriptor:n.descriptors.formButtonPrimary}),(0,o.tZ)(s.NavigateToFlowStartButton,{localizationKey:(0,n.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:n.descriptors.formButtonReset})]})]})]})},D=e=>{const{onVerified:t,resourceRef:i}=e,a=(0,s.useCardState)(),c=(0,l.useCoreUser)(),d=(0,m._m)(),[p,h]=r.useState(!1),P=(0,f.Yp)("code",""),g=(0,s.useCodeControl)(P),y=async e=>{(0,f.S3)(e,[P],a.setError),d.setIdle(),await(0,f._v)(750),g.reset()};return g.onCodeEntryFinished((e=>(d.setLoading(),P.setError(void 0),c.verifyTOTP({code:e}).then((e=>(async e=>{h(!0),i.current=e,await(0,f._v)(750),t()})(e))).catch(y)))),(0,o.BX)(s.ContentPage,{headerTitle:(0,n.localizationKeys)("userProfile.mfaTOTPPage.title"),Breadcrumbs:u._,children:[(0,o.tZ)(n.Col,{children:(0,o.tZ)(b.T,{title:(0,n.localizationKeys)("userProfile.mfaTOTPPage.verifyTitle"),subtitle:(0,n.localizationKeys)("userProfile.mfaTOTPPage.verifySubtitle"),isLoading:d.isLoading,success:p,codeControl:g})}),(0,o.tZ)(s.FormButtonContainer,{sx:{marginTop:0},children:(0,o.tZ)(s.NavigateToFlowStartButton,{localizationKey:(0,n.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:n.descriptors.formButtonReset})})]})},M=(0,s.withCardStateProvider)((()=>{var e;const t=(0,a.a2)(),i=r.useRef();return(0,o.BX)(a.en,{...t.props,children:[(0,o.tZ)($,{title:(0,n.localizationKeys)("userProfile.mfaTOTPPage.title"),onContinue:t.nextStep}),(0,o.tZ)(D,{onVerified:t.nextStep,resourceRef:i}),(0,o.tZ)(s.SuccessPage,{title:(0,n.localizationKeys)("userProfile.mfaTOTPPage.title"),text:(0,n.localizationKeys)("userProfile.mfaTOTPPage.successMessage"),contents:(0,o.tZ)(R,{subtitle:(0,n.localizationKeys)("userProfile.backupCodePage.successSubtitle"),backupCodes:null===(e=i.current)||void 0===e?void 0:e.backupCodes}),Breadcrumbs:u._})]})})),O=(0,s.withCardStateProvider)((()=>{const e=(0,s.useCardState)(),{userSettings:{attributes:t}}=(0,l.useEnvironment)(),i=(0,l.useCoreUser)(),a=(0,n.localizationKeys)("userProfile.mfaPage.title"),[c,d]=r.useState(),m=r.useMemo((()=>v(t,i)),[]);return r.useEffect((()=>{0===m.length&&e.setError("There are no second factors available to add")}),[]),e.error?(0,o.tZ)(s.ContentPage,{headerTitle:a,Breadcrumbs:u._}):1===m.length||c?(0,o.tZ)(q,{method:c||m[0]}):(0,o.BX)(s.ContentPage,{headerTitle:a,Breadcrumbs:u._,children:[(0,o.BX)(n.Col,{gap:4,children:[(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.mfaPage.formHint")}),(0,o.tZ)(n.Grid,{gap:2,sx:e=>({gridTemplateColumns:`repeat(3, minmax(${e.sizes.$24}, 1fr))`,gridAutoRows:e.sizes.$24,[B.mqu.sm]:{gridTemplateColumns:`repeat(2, minmax(${e.sizes.$24}, 1fr))`}}),children:m.map(((e,t)=>(0,o.tZ)(W,{method:e,setSelectedMethod:d},t)))})]}),(0,o.tZ)(s.FormButtonContainer,{sx:{marginTop:0},children:(0,o.tZ)(s.NavigateToFlowStartButton,{localizationKey:(0,n.localizationKeys)("userProfile.formButtonReset")})})]})})),q=e=>{const{method:t}=e;switch(t){case"phone_code":return(0,o.tZ)(E,{});case"totp":return(0,o.tZ)(M,{});case"backup_code":return(0,o.tZ)(k,{});default:return null}},W=e=>{const{method:t,setSelectedMethod:i}=e;let r,a;if("phone_code"===t)r=A.ij,a="SMS code";else if("totp"===t)r=A.hc,a="Authenticator application";else{if("backup_code"!==t)return null;r=A.TZ,a="Backup code"}return(0,o.tZ)(s.TileButton,{icon:r,onClick:()=>i(t),children:a})},H=(e,t)=>{const i=[];return e?i.push((0,n.localizationKeys)("userProfile.passwordPage.changePasswordSuccessMessage")):i.push((0,n.localizationKeys)("userProfile.passwordPage.successMessage")),t&&i.push((0,n.localizationKeys)("userProfile.passwordPage.sessionsSignedOutSuccessMessage")),i},V=(0,s.withCardStateProvider)((()=>{const e=(0,l.useCoreUser)(),t=(0,l.useCoreSession)(),i=e.passwordEnabled?(0,n.localizationKeys)("userProfile.passwordPage.changePasswordTitle"):(0,n.localizationKeys)("userProfile.passwordPage.title"),c=(0,s.useCardState)(),d=(0,a.a2)(),{navigateToFlowStart:p}=(0,s.useNavigateToFlowStart)(),h=e.samlAccounts.some((e=>e.active)),P=(0,r.useRef)({title:(0,n.localizationKeys)("userProfile.passwordPage.title")}),g=(0,f.Yp)("currentPassword","",{type:"password",label:(0,n.localizationKeys)("formFieldLabel__currentPassword"),isRequired:!0}),{userSettings:{passwordSettings:y}}=(0,l.useEnvironment)(),{failedValidationsText:v}=(0,m.el)(y),b=(0,f.Yp)("newPassword","",{type:"password",label:(0,n.localizationKeys)("formFieldLabel__newPassword"),isRequired:!0,enableErrorAfterBlur:!0,validatePassword:!0,informationText:v}),S=(0,f.Yp)("confirmPassword","",{type:"password",label:(0,n.localizationKeys)("formFieldLabel__confirmPassword"),isRequired:!0,enableErrorAfterBlur:!0}),z=(0,f.Yp)("signOutOfOtherSessions","",{type:"checkbox",label:(0,n.localizationKeys)("formFieldLabel__signOutOfOtherSessions"),defaultChecked:!0}),{displayConfirmPasswordFeedback:Z,isPasswordMatch:C}=(0,m.p5)({passwordField:b,confirmPasswordField:S}),K=!!b.errorText||!!S.errorText,_=(e.passwordEnabled?g.value&&C:C)&&!K;return(0,o.BX)(a.en,{...d.props,children:[(0,o.BX)(s.ContentPage,{headerTitle:i,Breadcrumbs:u._,children:[h&&(0,o.tZ)(s.InformationBox,{message:(0,n.localizationKeys)("userProfile.passwordPage.readonly")}),(0,o.BX)(s.Form.Root,{onSubmit:async()=>{const t={newPassword:b.value,signOutOfOtherSessions:z.checked,currentPassword:e.passwordEnabled?g.value:void 0};try{P.current={title:e.passwordEnabled?(0,n.localizationKeys)("userProfile.passwordPage.changePasswordTitle"):(0,n.localizationKeys)("userProfile.passwordPage.title"),text:H(e.passwordEnabled,!!z.checked),Breadcrumbs:u._},await e.updatePassword(t),d.nextStep()}catch(e){(0,f.S3)(e,[g,b,S],c.setError)}},onBlur:()=>{Z(S.value)},children:[(0,o.tZ)("input",{readOnly:!0,id:"identifier-field",name:"identifier",value:t.publicUserData.identifier||"",style:{display:"none"}}),e.passwordEnabled&&(0,o.tZ)(s.Form.ControlRow,{elementId:g.id,children:(0,o.tZ)(s.Form.Control,{...g.props,minLength:6,required:!0,autoFocus:!0,isDisabled:h})}),(0,o.tZ)(s.Form.ControlRow,{elementId:b.id,children:(0,o.tZ)(s.Form.Control,{...b.props,minLength:6,required:!0,autoFocus:!e.passwordEnabled,isDisabled:h})}),(0,o.tZ)(s.Form.ControlRow,{elementId:S.id,children:(0,o.tZ)(s.Form.Control,{...S.props,onChange:e=>(Z(e.target.value),S.props.onChange(e)),isDisabled:h})}),(0,o.tZ)(s.Form.ControlRow,{elementId:z.id,children:(0,o.tZ)(s.Form.Control,{...z.props,isDisabled:h})}),h?(0,o.tZ)(s.FormButtonContainer,{children:(0,o.tZ)(s.Form.ResetButton,{localizationKey:(0,n.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:p})}):(0,o.tZ)(s.FormButtons,{isDisabled:!_})]})]}),(0,o.tZ)(s.SuccessPage,{...P.current})]})}));var Y=i(4334);const j=e=>{const{user:t,...i}=e;return(0,o.tZ)(s.AvatarUploader,{...i,title:(0,Y.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,o.tZ)(s.UserAvatar,{size:e=>e.sizes.$11,...t})})},Q=(0,s.withCardStateProvider)((()=>{const e=(0,n.localizationKeys)("userProfile.profilePage.title"),t=(0,s.useCardState)(),i=(0,l.useCoreUser)(),[c,m]=r.useState(!1),{first_name:p,last_name:h}=(0,l.useEnvironment)().userSettings.attributes,P=p.enabled,g=h.enabled,y=i.firstName||"",v=i.lastName||"",b=(0,a.a2)({onNextStep:()=>t.setError(void 0)}),S=(0,f.Yp)("firstName",i.firstName||"",{type:"text",label:(0,n.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,n.localizationKeys)("formFieldInputPlaceholder__firstName")}),z=(0,f.Yp)("lastName",i.lastName||"",{type:"text",label:(0,n.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,n.localizationKeys)("formFieldInputPlaceholder__lastName")}),Z=P&&S.value!==y||g&&z.value!==v,C=Z||c,K=P&&p.required||g&&h.required,_=K&&!!z.value&&!!S.value&&C,B=i.samlAccounts.some((e=>e.active));return(0,o.BX)(a.en,{...b.props,children:[(0,o.BX)(s.ContentPage,{headerTitle:e,Breadcrumbs:u._,children:[B&&(0,o.tZ)(s.InformationBox,{message:(0,n.localizationKeys)("userProfile.profilePage.readonly")}),(0,o.BX)(s.Form.Root,{onSubmit:async e=>(e.preventDefault(),(Z?i.update({firstName:S.value,lastName:z.value}):Promise.resolve()).then((()=>{b.nextStep()})).catch((e=>{(0,f.S3)(e,[S,z],t.setError)}))),children:[(0,o.tZ)(j,{user:i,onAvatarChange:e=>i.setProfileImage({file:e}).then((()=>{m(!0),t.setIdle()})).catch((e=>(0,f.S3)(e,[],t.setError))),onAvatarRemove:(0,d.QO)(i.imageUrl)?null:()=>{i.setProfileImage({file:null}).then((()=>{m(!0),t.setIdle()})).catch((e=>(0,f.S3)(e,[],t.setError)))}}),P&&(0,o.tZ)(s.Form.ControlRow,{elementId:S.id,children:(0,o.tZ)(s.Form.Control,{autoFocus:!0,...S.props,required:p.required,isDisabled:B})}),g&&(0,o.tZ)(s.Form.ControlRow,{elementId:z.id,children:(0,o.tZ)(s.Form.Control,{...z.props,required:h.required,isDisabled:B})}),(0,o.tZ)(s.FormButtons,{isDisabled:K?!_:!C})]})]}),(0,o.tZ)(s.SuccessPage,{title:e,text:(0,n.localizationKeys)("userProfile.profilePage.successMessage"),Breadcrumbs:u._})]})})),G=()=>{const e=(0,l.useCoreUser)(),{id:t}=(0,c.useRouter)().params,i=e.emailAddresses.find((e=>e.id===t)),a=r.useRef(null==i?void 0:i.emailAddress);return a.current?(0,o.tZ)(re,{title:(0,n.localizationKeys)("userProfile.emailAddressPage.removeResource.title"),messageLine1:(0,n.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine1",{identifier:a.current}),messageLine2:(0,n.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine2"),successMessage:(0,n.localizationKeys)("userProfile.emailAddressPage.removeResource.successMessage",{emailAddress:a.current}),deleteResource:()=>Promise.resolve(null==i?void 0:i.destroy())}):null},J=()=>{const e=(0,l.useCoreUser)(),{id:t}=(0,c.useRouter)().params,i=e.phoneNumbers.find((e=>e.id===t)),a=r.useRef(null==i?void 0:i.phoneNumber);return a.current?(0,o.tZ)(re,{title:(0,n.localizationKeys)("userProfile.phoneNumberPage.removeResource.title"),messageLine1:(0,n.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine1",{identifier:a.current}),messageLine2:(0,n.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine2"),successMessage:(0,n.localizationKeys)("userProfile.phoneNumberPage.removeResource.successMessage",{phoneNumber:a.current}),deleteResource:()=>Promise.resolve(null==i?void 0:i.destroy())}):null},ee=()=>{var e,t;const i=(0,l.useCoreUser)(),{id:a}=(0,c.useRouter)().params,s=i.externalAccounts.find((e=>e.id===a)),u=r.useRef(null==s?void 0:s.provider),{providerToDisplayData:d}=(0,m.vO)();return u.current?(0,o.tZ)(re,{title:(0,n.localizationKeys)("userProfile.connectedAccountPage.removeResource.title"),messageLine1:(0,n.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine1",{identifier:null===(e=d[u.current])||void 0===e?void 0:e.name}),messageLine2:(0,n.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine2"),successMessage:(0,n.localizationKeys)("userProfile.connectedAccountPage.removeResource.successMessage",{connectedAccount:null===(t=d[u.current])||void 0===t?void 0:t.name}),deleteResource:()=>Promise.resolve(null==s?void 0:s.destroy())}):null},te=()=>{const e=(0,l.useCoreUser)(),{id:t}=(0,c.useRouter)().params,i=e.web3Wallets.find((e=>e.id===t)),a=r.useRef(null==i?void 0:i.web3Wallet);return a.current?(0,o.tZ)(re,{title:(0,n.localizationKeys)("userProfile.web3WalletPage.removeResource.title"),messageLine1:(0,n.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine1",{identifier:a.current}),messageLine2:(0,n.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine2"),successMessage:(0,n.localizationKeys)("userProfile.web3WalletPage.removeResource.successMessage",{web3Wallet:a.current}),deleteResource:()=>Promise.resolve(null==i?void 0:i.destroy())}):null},ie=()=>{const e=(0,l.useCoreUser)(),{id:t}=(0,c.useRouter)().params,i=e.phoneNumbers.find((e=>e.id===t)),a=r.useRef(null==i?void 0:i.phoneNumber);return a.current?(0,o.tZ)(re,{title:(0,n.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.title"),messageLine1:(0,n.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine1",{identifier:a.current}),messageLine2:(0,n.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine2"),successMessage:(0,n.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.successMessage",{mfaPhoneCode:a.current}),deleteResource:()=>Promise.resolve(null==i?void 0:i.setReservedForSecondFactor({reserved:!1}))}):null},oe=()=>{const e=(0,l.useCoreUser)();return(0,o.tZ)(re,{title:(0,n.localizationKeys)("userProfile.mfaTOTPPage.removeResource.title"),messageLine1:(0,n.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine1"),messageLine2:(0,n.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine2"),successMessage:(0,n.localizationKeys)("userProfile.mfaTOTPPage.removeResource.successMessage"),deleteResource:e.disableTOTP})},re=(0,s.withCardStateProvider)((e=>{const{title:t,messageLine1:i,messageLine2:r,successMessage:l,deleteResource:c}=e,d=(0,a.a2)(),m=(0,s.useCardState)();return(0,o.BX)(a.en,{...d.props,children:[(0,o.tZ)(s.ContentPage,{headerTitle:t,Breadcrumbs:u._,children:(0,o.BX)(s.Form.Root,{onSubmit:async()=>{try{await c().then((()=>d.nextStep()))}catch(e){(0,f.S3)(e,[],m.setError)}},children:[(0,o.tZ)(n.Text,{localizationKey:i,variant:"regularRegular"}),(0,o.tZ)(n.Text,{localizationKey:r,variant:"regularRegular"}),(0,o.tZ)(s.FormButtons,{colorScheme:"danger"})]})}),(0,o.tZ)(s.SuccessPage,{title:t,text:l,Breadcrumbs:u._})]})}));var ae=i(6465);const le=e=>{const{title:t,subtitle:i,actionLabel:r,titleLabel:a,onClick:l,...s}=e,c=(0,m._m)(),{t:u}=(0,n.useLocalizations)();return(0,o.BX)(n.Col,{gap:2,children:[(0,o.BX)(n.Col,{gap:1,children:[(0,o.BX)(n.Flex,{gap:2,align:"center",children:[(0,o.tZ)(n.Text,{localizationKey:t,variant:"regularMedium"}),a]}),(0,o.tZ)(n.Text,{localizationKey:i,variant:"smallRegular",colorScheme:"neutral"})]}),r&&(0,o.tZ)(n.Button,{localizationKey:r,loadingText:u(r),colorScheme:"primary",variant:"link",...s,isLoading:c.isLoading,onClick:e=>{var t;c.setLoading(),l&&(null===(t=null==l?void 0:l(e))||void 0===t||t.finally((()=>c.setIdle())))}})]})},ne=e=>{const t="modal"===(0,l.useUserProfileContext)().mode;return(0,o.tZ)(s.AccordionItem,{scrollOnOpen:t,...e})},se=()=>{const e=(0,l.useCoreUser)(),t=(0,l.useCoreSession)(),[i,a]=r.useState([]);return r.useEffect((()=>{null==e||e.getSessions().then((e=>a(e)))}),[e]),(0,o.BX)(s.ProfileSection,{title:(0,n.localizationKeys)("userProfile.start.activeDevicesSection.title"),id:"activeDevices",children:[!i.length&&(0,o.tZ)(s.FullHeightLoader,{}),!!i.length&&i.sort((c=null==t?void 0:t.id,e=>e.id===c?-1:1)).map((e=>(0,o.tZ)(ce,{session:e},e.id)))]});var c},ce=e=>{var t;const i=(null===(t=(0,l.useCoreSession)())||void 0===t?void 0:t.id)===e.session.id;return(0,o.tZ)(ne,{title:(0,o.tZ)(ue,{session:e.session}),children:(0,o.BX)(n.Col,{gap:4,children:[i&&(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.activeDevicesSection.detailsTitle"),subtitle:(0,n.localizationKeys)("userProfile.start.activeDevicesSection.detailsSubtitle")}),!i&&(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.activeDevicesSection.destructiveActionTitle"),subtitle:(0,n.localizationKeys)("userProfile.start.activeDevicesSection.destructiveActionSubtitle"),actionLabel:(0,n.localizationKeys)("userProfile.start.activeDevicesSection.destructiveAction"),colorScheme:"danger",onClick:async()=>{if(!i&&e.session)return e.session.revoke()}})]})})},ue=e=>{const t=(0,l.useCoreSession)(),i=(null==t?void 0:t.id)===e.session.id,r=!!t.actor,a=!!e.session.actor,{city:s,country:c,browserName:u,browserVersion:d,deviceType:m,ipAddress:p,isMobile:h}=e.session.latestActivity,P=m||(h?"Mobile device":"Desktop device"),g=`${u||""} ${d||""}`.trim()||"Web browser",y=[s||"",c||""].filter(Boolean).join(", ").trim()||null,{t:v}=(0,n.useLocalizations)();return(0,o.BX)(n.Flex,{align:"center",sx:e=>({gap:e.space.$8,[B.mqu.xs]:{gap:e.space.$2}}),children:[(0,o.tZ)(n.Flex,{center:!0,sx:e=>({padding:`0 ${e.space.$3}`,[B.mqu.sm]:{padding:"0"},borderRadius:e.radii.$md}),children:(0,o.tZ)(n.Icon,{elementDescriptor:n.descriptors.activeDeviceIcon,elementId:n.descriptors.activeDeviceIcon.setId(h?"mobile":"desktop"),icon:h?A.Fh:A.eu,sx:e=>({"--cl-chassis-bottom":"#444444","--cl-chassis-back":"#343434","--cl-chassis-screen":"#575757","--cl-screen":"#000000",width:e.space.$20,height:e.space.$20,[B.mqu.sm]:{width:e.space.$10,height:e.space.$10}})})}),(0,o.BX)(n.Col,{align:"start",gap:1,children:[(0,o.BX)(n.Flex,{center:!0,gap:2,children:[(0,o.tZ)(n.Text,{variant:"smallMedium",children:P}),i&&(0,o.tZ)(n.Badge,{localizationKey:(0,n.localizationKeys)("badge__thisDevice"),colorScheme:r?"danger":"primary"}),r&&!a&&(0,o.tZ)(n.Badge,{localizationKey:(0,n.localizationKeys)("badge__userDevice")}),!i&&a&&(0,o.tZ)(n.Badge,{localizationKey:(0,n.localizationKeys)("badge__otherImpersonatorDevice"),colorScheme:"danger"})]}),(0,o.tZ)(n.Text,{variant:"smallRegular",colorScheme:"neutral",children:g}),(0,o.BX)(n.Text,{variant:"smallRegular",colorScheme:"neutral",children:[p," (",y,")"]}),(0,o.tZ)(n.Text,{variant:"smallRegular",colorScheme:"neutral",children:v((0,f.Qg)(e.session.lastActiveAt))})]})]})},de=()=>{const e=(0,l.useCoreUser)(),{navigate:t}=(0,c.useRouter)(),i=[...e.verifiedExternalAccounts,...e.unverifiedExternalAccounts.filter((e=>{var t;return null===(t=e.verification)||void 0===t?void 0:t.error}))];return(0,o.BX)(s.ProfileSection,{title:(0,n.localizationKeys)("userProfile.start.connectedAccountsSection.title"),id:"connectedAccounts",children:[i.map((e=>(0,o.tZ)(me,{account:e},e.id))),(0,o.tZ)(X.B,{textLocalizationKey:(0,n.localizationKeys)("userProfile.start.connectedAccountsSection.primaryButton"),id:"connectedAccounts",onClick:()=>t("connected-account")})]})},me=({account:e})=>{var t,i,r,a,u;const p=(0,s.useCardState)(),h=(0,l.useCoreUser)(),{navigate:P}=(0,c.useRouter)(),g=(0,c.useRouter)(),{providerToDisplayData:y}=(0,m.vO)(),v=null===(i=null===(t=e.verification)||void 0===t?void 0:t.error)||void 0===i?void 0:i.longMessage,b=e.username||e.emailAddress,S=!!(null===(r=g.urlStateParam)||void 0===r?void 0:r.componentName),{additionalOAuthScopes:z,componentName:Z,mode:C}=(0,l.useUserProfileContext)(),K="modal"===C,_=e.provider===(null===(a=g.urlStateParam)||void 0===a?void 0:a.socialProvider),B=function(e,t){if(!t)return[];const i=t[e.provider]||[],o=e.approvedScopes.split(" ");return 0===i.filter((e=>!o.includes(e))).length?[]:i}(e,z),w=B.length>0&&""!=e.approvedScopes,R=w?(0,n.localizationKeys)("userProfile.start.connectedAccountsSection.title__reauthorize"):(0,n.localizationKeys)("userProfile.start.connectedAccountsSection.title__connectionFailed"),T=w?(0,n.localizationKeys)("userProfile.start.connectedAccountsSection.subtitle__reauthorize"):v,x=w?(0,n.localizationKeys)("userProfile.start.connectedAccountsSection.actionLabel__reauthorize"):(0,n.localizationKeys)("userProfile.start.connectedAccountsSection.actionLabel__connectionFailed");return(0,o.tZ)(ne,{defaultOpen:_&&S,onCloseCallback:null===(u=g.urlStateParam)||void 0===u?void 0:u.clearUrlStateParam,icon:(0,o.tZ)(n.Image,{elementDescriptor:[n.descriptors.providerIcon],elementId:n.descriptors.socialButtonsProviderIcon.setId(e.provider),alt:y[e.provider].name,src:y[e.provider].iconUrl,sx:e=>({width:e.sizes.$4})}),title:(0,o.BX)(n.Flex,{gap:2,center:!0,children:[`${y[e.provider].name} ${b?`(${b})`:""}`,(v||w)&&(0,o.tZ)(n.Badge,{colorScheme:"danger",localizationKey:(0,n.localizationKeys)("badge__requiresAction")})]}),children:(0,o.BX)(n.Col,{gap:4,children:[(0,o.tZ)(s.UserPreview,{externalAccount:e,size:"lg",icon:(0,o.tZ)(n.Image,{alt:y[e.provider].name,src:y[e.provider].iconUrl,sx:e=>({width:e.sizes.$4})})}),(v||w)&&(0,o.tZ)(le,{title:R,subtitle:T,actionLabel:x,onClick:async()=>{var t;const i=K?(0,d.bX)({url:window.location.href,componentName:Z}):window.location.href;try{let o;o=w?await e.reauthorize({additionalScopes:B,redirectUrl:i}):await h.createExternalAccount({strategy:e.verification.strategy,redirectUrl:i,additionalScopes:B}),await P((null===(t=o.verification.externalVerificationRedirectURL)||void 0===t?void 0:t.href)||"")}catch(e){(0,f.S3)(e,[],p.setError)}}}),(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.connectedAccountsSection.destructiveActionTitle"),subtitle:(0,n.localizationKeys)("userProfile.start.connectedAccountsSection.destructiveActionSubtitle"),actionLabel:(0,n.localizationKeys)("userProfile.start.connectedAccountsSection.destructiveActionAccordionSubtitle"),colorScheme:"danger",onClick:()=>P(`connected-account/${e.id}/remove`)})]})})},fe=()=>{const{navigate:e}=(0,c.useRouter)(),t=(0,l.useCoreUser)();return(0,o.BX)(s.ProfileSection,{title:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.title"),id:"emailAddresses",children:[t.emailAddresses.sort(P(t.primaryEmailAddressId)).map((e=>(0,o.tZ)(pe,{email:e},e.id))),(0,o.tZ)(X.B,{textLocalizationKey:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.primaryButton"),id:"emailAddresses",onClick:()=>e("email-address")})]})},pe=({email:e})=>{const t=(0,s.useCardState)(),i=(0,l.useCoreUser)(),{navigate:r}=(0,c.useRouter)(),a=i.primaryEmailAddressId===e.id,u="verified"===e.verification.status;return(0,o.tZ)(ne,{title:e.emailAddress,badge:a?(0,o.tZ)(n.Badge,{localizationKey:(0,n.localizationKeys)("badge__primary")}):void 0,children:(0,o.BX)(n.Col,{gap:4,children:[a&&u&&(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.detailsTitle__primary"),subtitle:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.detailsSubtitle__primary")}),a&&!u&&(0,o.tZ)(le,{titleLabel:(0,o.tZ)(n.Badge,{localizationKey:(0,n.localizationKeys)("badge__unverified"),colorScheme:"warning"}),title:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.detailsTitle__primary"),subtitle:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.detailsSubtitle__primary"),actionLabel:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__primary"),onClick:()=>r(`email-address/${e.id}`)}),!a&&u&&(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.detailsTitle__nonPrimary"),subtitle:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.detailsSubtitle__nonPrimary"),actionLabel:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__nonPrimary"),onClick:()=>i.update({primaryEmailAddressId:e.id}).catch((e=>(0,f.S3)(e,[],t.setError)))}),!a&&!u&&(0,o.tZ)(le,{titleLabel:(0,o.tZ)(n.Badge,{localizationKey:(0,n.localizationKeys)("badge__unverified"),colorScheme:"warning"}),title:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.detailsTitle__unverified"),subtitle:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.detailsSubtitle__unverified"),actionLabel:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__unverified"),onClick:()=>r(`email-address/${e.id}`)}),(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.destructiveActionTitle"),subtitle:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.destructiveActionSubtitle"),actionLabel:(0,n.localizationKeys)("userProfile.start.emailAddressesSection.destructiveAction"),colorScheme:"danger",onClick:()=>r(`email-address/${e.id}/remove`)})]})})},he=()=>{const e=(0,l.useCoreUser)();return(0,o.tZ)(s.ProfileSection,{title:(0,n.localizationKeys)("userProfile.start.enterpriseAccountsSection.title"),id:"enterpriseAccounts",children:e.samlAccounts.map((e=>(0,o.tZ)(Pe,{account:e},e.id)))})},Pe=({account:e})=>{var t,i,r;const a=(0,c.useRouter)(),{getSamlProviderLogoUrl:l,getSamlProviderName:u}=(0,m.n$)(),d=null===(i=null===(t=e.verification)||void 0===t?void 0:t.error)||void 0===i?void 0:i.longMessage,f=e.emailAddress,p=u(e.provider),h=l(e.provider);return(0,o.tZ)(ne,{onCloseCallback:null===(r=a.urlStateParam)||void 0===r?void 0:r.clearUrlStateParam,icon:(0,o.tZ)(n.Image,{elementDescriptor:[n.descriptors.providerIcon],elementId:n.descriptors.enterpriseButtonsProviderIcon.setId(e.provider),alt:p,src:h,sx:e=>({width:e.sizes.$4})}),title:(0,o.BX)(n.Flex,{gap:2,center:!0,children:[`${p} ${f?`(${f})`:""}`,d&&(0,o.tZ)(n.Badge,{colorScheme:"danger",localizationKey:(0,n.localizationKeys)("badge__requiresAction")})]}),children:(0,o.tZ)(n.Col,{gap:4,children:(0,o.tZ)(s.UserPreview,{samlAccount:e,size:"lg",icon:(0,o.tZ)(n.Image,{alt:p,src:h,sx:e=>({width:e.sizes.$4})})})})})},ge=()=>{const{navigate:e}=(0,c.useRouter)(),{t:t}=(0,n.useLocalizations)();return(0,o.tZ)(ne,{icon:(0,o.tZ)(n.Icon,{icon:A.TZ,sx:e=>({color:e.colors.$blackAlpha700})}),title:t((0,n.localizationKeys)("userProfile.start.mfaSection.backupCodes.headerTitle")),children:(0,o.tZ)(n.Col,{gap:4,children:(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.mfaSection.backupCodes.title__regenerate"),subtitle:(0,n.localizationKeys)("userProfile.start.mfaSection.backupCodes.subtitle__regenerate"),actionLabel:(0,n.localizationKeys)("userProfile.start.mfaSection.backupCodes.actionLabel__regenerate"),onClick:()=>e("multi-factor/backup_code/add")})})})},ye=({phone:e,showTOTP:t})=>{const{navigate:i}=(0,c.useRouter)(),r=(0,s.useCardState)(),a=!t&&e.defaultSecondFactor;return(0,o.tZ)(ne,{icon:(0,o.tZ)(n.Icon,{icon:A.ij,sx:e=>({color:e.colors.$blackAlpha700})}),title:(0,o.BX)(o.HY,{children:["SMS Code ",(0,o.tZ)(s.FormattedPhoneNumberText,{value:e.phoneNumber})]}),badge:a?(0,o.tZ)(n.Badge,{localizationKey:(0,n.localizationKeys)("badge__default")}):void 0,children:(0,o.BX)(n.Col,{gap:4,children:[!t&&(0,o.tZ)(le,{title:(0,n.localizationKeys)(a?"userProfile.start.mfaSection.phoneCode.title__default":"userProfile.start.mfaSection.phoneCode.title__setDefault"),subtitle:(0,n.localizationKeys)(a?"userProfile.start.mfaSection.phoneCode.subtitle__default":"userProfile.start.mfaSection.phoneCode.subtitle__setDefault"),actionLabel:a?void 0:(0,n.localizationKeys)("userProfile.start.mfaSection.phoneCode.actionLabel__setDefault"),onClick:()=>e.makeDefaultSecondFactor().catch((e=>(0,f.S3)(e,[],r.setError)))}),(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.mfaSection.phoneCode.destructiveActionTitle"),subtitle:(0,n.localizationKeys)("userProfile.start.mfaSection.phoneCode.destructiveActionSubtitle"),actionLabel:(0,n.localizationKeys)("userProfile.start.mfaSection.phoneCode.destructiveActionLabel"),colorScheme:"danger",onClick:()=>i(`multi-factor/${e.id}/remove`)})]})})},ve=()=>{const{navigate:e}=(0,c.useRouter)(),{t:t}=(0,n.useLocalizations)();return(0,o.tZ)(ne,{icon:(0,o.tZ)(n.Icon,{icon:A.hc,sx:e=>({color:e.colors.$blackAlpha700})}),title:t((0,n.localizationKeys)("userProfile.start.mfaSection.totp.headerTitle")),badge:(0,o.tZ)(n.Badge,{localizationKey:(0,n.localizationKeys)("badge__default")}),children:(0,o.BX)(n.Col,{gap:4,children:[(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.mfaSection.totp.title"),subtitle:(0,n.localizationKeys)("userProfile.start.mfaSection.totp.subtitle")}),(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.mfaSection.totp.destructiveActionTitle"),subtitle:(0,n.localizationKeys)("userProfile.start.mfaSection.totp.destructiveActionSubtitle"),actionLabel:(0,n.localizationKeys)("userProfile.start.mfaSection.totp.destructiveActionLabel"),colorScheme:"danger",onClick:()=>e("multi-factor/totp/remove")})]})})},be=()=>{const{navigate:e}=(0,c.useRouter)(),{userSettings:{attributes:t}}=(0,l.useEnvironment)(),i=(0,l.useCoreUser)(),r=y(t),a=v(t,i),u=r.includes("totp")&&i.totpEnabled,d=r.includes("backup_code")&&i.backupCodeEnabled,m=i.phoneNumbers.filter((e=>"verified"===e.verification.status)).filter((e=>e.reservedForSecondFactor)).sort(g);return(0,o.BX)(s.ProfileSection,{title:(0,n.localizationKeys)("userProfile.start.mfaSection.title"),id:"mfa",children:[u&&(0,o.tZ)(ve,{}),r.includes("phone_code")&&m.map((e=>(0,o.tZ)(ye,{phone:e,showTOTP:u},e.id))),d&&(0,o.tZ)(ge,{}),a.length>0&&(0,o.tZ)(X.B,{textLocalizationKey:(0,n.localizationKeys)("userProfile.start.mfaSection.primaryButton"),id:"mfa",onClick:()=>e("multi-factor")})]})},Se=()=>{const{navigate:e}=(0,c.useRouter)(),{passwordEnabled:t}=(0,l.useCoreUser)();return(0,o.BX)(s.ProfileSection,{title:(0,n.localizationKeys)("userProfile.start.passwordSection.title"),id:"password",children:[t&&(0,o.tZ)(n.Text,{variant:"smallRegular",sx:e=>({padding:`${e.space.$2} ${e.space.$4}`}),children:"••••••••••"}),(0,o.tZ)(X.B,{id:"password",onClick:()=>e("password"),leftIcon:t?A.z:void 0,textLocalizationKey:t?(0,n.localizationKeys)("userProfile.start.passwordSection.primaryButton__changePassword"):(0,n.localizationKeys)("userProfile.start.passwordSection.primaryButton__setPassword")})]})},ze=()=>{const e=(0,l.useCoreUser)(),{navigate:t}=(0,c.useRouter)();return(0,o.BX)(s.ProfileSection,{title:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.title"),id:"phoneNumbers",children:[e.phoneNumbers.sort(P(e.primaryPhoneNumberId)).map((e=>(0,o.tZ)(Ze,{phone:e},e.id))),(0,o.tZ)(X.B,{textLocalizationKey:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.primaryButton"),id:"password",onClick:()=>t("phone-number")})]})},Ze=({phone:e})=>{const t=(0,s.useCardState)(),i=(0,l.useCoreUser)(),{navigate:r}=(0,c.useRouter)(),a=i.primaryPhoneNumberId===e.id,u="verified"===e.verification.status,d=(0,f.L_)(e.phoneNumber),m=(0,f.uz)((0,f.y3)(e.phoneNumber).iso);return(0,o.tZ)(ne,{icon:(0,o.tZ)(n.Text,{as:"span",sx:e=>({fontSize:e.fontSizes.$sm}),children:m}),title:d,badge:a?(0,o.tZ)(n.Badge,{localizationKey:(0,n.localizationKeys)("badge__primary")}):void 0,children:(0,o.BX)(n.Col,{gap:4,children:[a&&u&&(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.detailsTitle__primary"),subtitle:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.detailsSubtitle__primary")}),a&&!u&&(0,o.tZ)(le,{titleLabel:(0,o.tZ)(n.Badge,{localizationKey:(0,n.localizationKeys)("badge__unverified"),colorScheme:"warning"}),title:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.detailsTitle__primary"),subtitle:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.detailsSubtitle__primary"),actionLabel:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__primary"),onClick:()=>r(`phone-number/${e.id}`)}),!a&&u&&(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.detailsTitle__nonPrimary"),subtitle:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.detailsSubtitle__nonPrimary"),actionLabel:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__nonPrimary"),onClick:()=>i.update({primaryPhoneNumberId:e.id}).catch((e=>(0,f.S3)(e,[],t.setError)))}),!a&&!u&&(0,o.tZ)(le,{titleLabel:(0,o.tZ)(n.Badge,{localizationKey:(0,n.localizationKeys)("badge__unverified"),colorScheme:"warning"}),title:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.detailsTitle__unverified"),subtitle:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.detailsSubtitle__unverified"),actionLabel:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__unverified"),onClick:()=>r(`phone-number/${e.id}`)}),(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.destructiveActionTitle"),subtitle:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.destructiveActionSubtitle"),actionLabel:(0,n.localizationKeys)("userProfile.start.phoneNumbersSection.destructiveAction"),colorScheme:"danger",onClick:()=>r(`phone-number/${e.id}/remove`)})]})})},Ce=()=>{const e=(0,l.useCoreUser)(),{navigate:t}=(0,c.useRouter)();return(0,o.BX)(s.ProfileSection,{title:(0,n.localizationKeys)("userProfile.start.usernameSection.title"),id:"username",children:[e.username&&(0,o.tZ)(n.Text,{variant:"smallRegular",sx:e=>({padding:`${e.space.$2} ${e.space.$4}`}),children:e.username}),(0,o.tZ)(X.B,{id:"username",onClick:()=>t("username"),leftIcon:e.username?A.z:void 0,textLocalizationKey:e.username?(0,n.localizationKeys)("userProfile.start.usernameSection.primaryButton__changeUsername"):(0,n.localizationKeys)("userProfile.start.usernameSection.primaryButton__setUsername")})]})},Ke=()=>{const{navigate:e}=(0,c.useRouter)(),{username:t,primaryEmailAddress:i,primaryPhoneNumber:r,...a}=(0,l.useCoreUser)();return(0,o.tZ)(s.ProfileSection,{title:(0,n.localizationKeys)("userProfile.start.profileSection.title"),id:"profile",children:(0,o.tZ)(X.o,{onClick:()=>e("profile"),children:(0,o.tZ)(s.UserPreview,{user:a,size:"lg"})})})},_e=()=>{const e=(0,l.useCoreUser)(),{navigate:t}=(0,c.useRouter)();return(0,o.BX)(s.ProfileSection,{title:(0,n.localizationKeys)("userProfile.start.web3WalletsSection.title"),id:"web3Wallets",children:[e.web3Wallets.map((e=>(0,o.tZ)(Be,{wallet:e},e.id))),(0,o.tZ)(X.B,{id:"password",onClick:()=>t("web3-wallet"),textLocalizationKey:(0,n.localizationKeys)("userProfile.start.web3WalletsSection.primaryButton")})]})},Be=({wallet:e})=>{const{navigate:t}=(0,c.useRouter)(),{strategyToDisplayData:i}=(0,m.vO)(),r=e.verification.strategy;return(0,o.tZ)(ne,{title:(0,o.BX)(n.Flex,{align:"center",gap:4,children:[(0,o.tZ)(n.Image,{src:i[r].iconUrl,alt:i[r].name,sx:e=>({width:e.sizes.$4})}),i[r].name," (",e.web3Wallet,")"]}),children:(0,o.tZ)(n.Col,{gap:4,children:(0,o.tZ)(le,{title:(0,n.localizationKeys)("userProfile.start.web3WalletsSection.destructiveActionTitle"),subtitle:(0,n.localizationKeys)("userProfile.start.web3WalletsSection.destructiveActionSubtitle"),actionLabel:(0,n.localizationKeys)("userProfile.start.web3WalletsSection.destructiveAction"),colorScheme:"danger",onClick:()=>t(`web3-wallet/${e.id}/remove`)})})})},we=()=>{const{navigate:e}=(0,c.useRouter)();return(0,o.tZ)(s.ProfileSection,{title:(0,n.localizationKeys)("userProfile.start.dangerSection.title"),id:"danger",children:(0,o.BX)(n.Flex,{justify:"between",sx:e=>({marginTop:e.space.$2,marginLeft:e.space.$6}),children:[(0,o.BX)(n.Col,{gap:1,children:[(0,o.tZ)(n.Text,{variant:"regularMedium",localizationKey:(0,n.localizationKeys)("userProfile.start.dangerSection.deleteAccountTitle")}),(0,o.tZ)(n.Text,{variant:"smallRegular",colorScheme:"neutral",localizationKey:(0,n.localizationKeys)("userProfile.start.dangerSection.deleteAccountDescription")})]}),(0,o.tZ)(n.Button,{"aria-label":"Delete account",colorScheme:"danger",textVariant:"buttonExtraSmallBold",onClick:()=>e("delete"),localizationKey:(0,n.localizationKeys)("userProfile.start.dangerSection.deleteAccountButton")})]})})},Re=(0,s.withCardStateProvider)((()=>{const{attributes:e,saml:t,social:i,instanceIsPasswordBased:r}=(0,l.useEnvironment)().userSettings,a=(0,s.useCardState)(),c=(0,l.useCoreUser)(),u=e.username.enabled,d=e.email_address.enabled,m=e.phone_number.enabled,f=i&&Object.values(i).filter((e=>e.enabled)).length>0,p=t&&t.enabled&&c.samlAccounts.length>0,h=e.web3_wallet.enabled,P=r,g=y(e).length>0,v=c.deleteSelfEnabled;return(0,o.BX)(n.Col,{elementDescriptor:n.descriptors.page,gap:8,children:[(0,o.tZ)(ae.ap,{}),(0,o.tZ)(s.CardAlert,{children:a.error}),(0,o.BX)(n.Col,{elementDescriptor:n.descriptors.profilePage,elementId:n.descriptors.profilePage.setId("account"),gap:8,children:[(0,o.BX)(s.Header.Root,{id:"cl-section-account",children:[(0,o.tZ)(s.Header.Title,{localizationKey:(0,n.localizationKeys)("userProfile.start.headerTitle__account"),textVariant:"xxlargeMedium"}),(0,o.tZ)(s.Header.Subtitle,{localizationKey:(0,n.localizationKeys)("userProfile.start.headerSubtitle__account")})]}),(0,o.tZ)(Ke,{}),u&&(0,o.tZ)(Ce,{}),d&&(0,o.tZ)(fe,{}),m&&(0,o.tZ)(ze,{}),f&&(0,o.tZ)(de,{}),p&&(0,o.tZ)(he,{}),h&&(0,o.tZ)(_e,{})]}),(0,o.BX)(n.Col,{elementDescriptor:n.descriptors.profilePage,elementId:n.descriptors.profilePage.setId("security"),gap:8,children:[(0,o.BX)(s.Header.Root,{id:"cl-section-security",children:[(0,o.tZ)(s.Header.Title,{localizationKey:(0,n.localizationKeys)("userProfile.start.headerTitle__security"),textVariant:"xxlargeMedium"}),(0,o.tZ)(s.Header.Subtitle,{localizationKey:(0,n.localizationKeys)("userProfile.start.headerSubtitle__security")})]}),P&&(0,o.tZ)(Se,{}),g&&(0,o.tZ)(be,{}),(0,o.tZ)(se,{}),v&&(0,o.tZ)(we,{})]})]})})),Te=(0,s.withCardStateProvider)((()=>{const e=(0,l.useCoreUser)(),t=(0,s.useCardState)(),i=(0,a.a2)(),r=(0,f.Yp)("username",e.username||"",{type:"text",label:(0,n.localizationKeys)("formFieldLabel__username"),placeholder:(0,n.localizationKeys)("formFieldInputPlaceholder__username")}),c=r.value.length>1&&e.username!==r.value;return(0,o.BX)(a.en,{...i.props,children:[(0,o.tZ)(s.ContentPage,{headerTitle:(0,n.localizationKeys)("userProfile.usernamePage.title"),Breadcrumbs:u._,children:(0,o.BX)(s.Form.Root,{onSubmit:async()=>{try{await e.update({username:r.value}),i.nextStep()}catch(e){(0,f.S3)(e,[r],t.setError)}},children:[(0,o.tZ)(s.Form.ControlRow,{elementId:r.id,children:(0,o.tZ)(s.Form.Control,{...r.props,required:!0,autoFocus:!0})}),(0,o.tZ)(s.FormButtons,{isDisabled:!c})]})}),(0,o.tZ)(s.SuccessPage,{title:(0,n.localizationKeys)("userProfile.usernamePage.title"),text:(0,n.localizationKeys)("userProfile.usernamePage.successMessage"),Breadcrumbs:u._})]})}));var xe=i(8621);const Ae=(0,s.withCardStateProvider)((()=>{const e=(0,l.useCoreUser)(),{params:t}=(0,c.useRouter)(),{id:i}=t||{},d=r.useRef(e.web3Wallets.find((e=>e.id===i))),m=(0,a.a2)({defaultStep:d.current?1:0});return(0,o.BX)(a.en,{...m.props,children:[(0,o.tZ)(ke,{nextStep:m.nextStep}),(0,o.tZ)(s.SuccessPage,{title:(0,n.localizationKeys)("userProfile.web3WalletPage.title"),text:(0,n.localizationKeys)("userProfile.web3WalletPage.successMessage"),Breadcrumbs:u._})]})})),ke=e=>{const{nextStep:t}=e,i=(0,s.useCardState)(),r=(0,l.useCoreUser)(),{strategyToDisplayData:a}=(0,m.vO)(),c=0===r.web3Wallets.filter((e=>{var t;return"verified"===(null===(t=e.verification)||void 0===t?void 0:t.status)})).length?["web3_metamask_signature"]:[];return(0,o.BX)(s.ContentPage,{headerTitle:(0,n.localizationKeys)("userProfile.web3WalletPage.title"),Breadcrumbs:u._,children:[(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)(c.length?"userProfile.web3WalletPage.subtitle__availableWallets":"userProfile.web3WalletPage.subtitle__unavailableWallets")}),(0,o.tZ)(n.Col,{gap:2,children:c.map((e=>(0,o.tZ)(s.ArrowBlockButton,{id:a[e].id,onClick:()=>(async e=>{try{i.setLoading(e);const o=await(0,xe.M)();let a=await r.createWeb3Wallet({web3Wallet:o});a=await a.prepareVerification({strategy:"web3_metamask_signature"});const l=a.verification.nonce,n=await(0,xe.w)({identifier:o,nonce:l});await a.attemptVerification({signature:n}),i.setIdle(),t()}catch(e){i.setIdle(),console.log(e);const t=(0,f.zQ)(e);t?i.setError(t.longMessage):(0,f.S3)(e,[],i.setError)}})(e),isLoading:i.loadingMetadata===e,isDisabled:i.isLoading,leftIcon:(0,o.tZ)(n.Image,{elementDescriptor:n.descriptors.socialButtonsProviderIcon,elementId:n.descriptors.socialButtonsProviderIcon.setId(a[e].id),isLoading:i.loadingMetadata===e,isDisabled:i.isLoading,src:a[e].iconUrl,alt:`Connect ${a[e].name}`,sx:e=>({width:e.sizes.$5})}),children:`Connect ${a[e].name} wallet`},e)))}),(0,o.tZ)(s.FormButtonContainer,{sx:{marginTop:0},children:(0,o.tZ)(s.NavigateToFlowStartButton,{localizationKey:(0,n.localizationKeys)("userProfile.formButtonReset")})})]})},Le=(0,s.withCardStateProvider)((()=>{const e=(0,s.useCardState)(),t=(0,l.useEnvironment)(),i=(0,c.useRouter)(),r=(0,l.useCoreUser)(),a=(0,l.useCoreClerk)(),d=(0,f.Yp)("deleteConfirmation","",{type:"text",label:(0,n.localizationKeys)("formFieldLabel__confirmDeletion"),isRequired:!0,placeholder:"Delete account"}),m="Delete account"===d.value;return(0,o.tZ)(s.ContentPage,{headerTitle:(0,n.localizationKeys)("userProfile.deletePage.title"),Breadcrumbs:u._,children:(0,o.BX)(s.Form.Root,{onSubmit:async()=>{try{await r.delete(),a.client.activeSessions.length>0?await i.navigate(t.displayConfig.afterSignOutOneUrl):await i.navigate(t.displayConfig.afterSignOutAllUrl)}catch(t){(0,f.S3)(t,[],e.setError)}},children:[(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.deletePage.messageLine1")}),(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.deletePage.messageLine2")}),(0,o.tZ)(n.Text,{localizationKey:(0,n.localizationKeys)("userProfile.deletePage.actionDescription")}),(0,o.tZ)(s.Form.ControlRow,{elementId:d.id,children:(0,o.tZ)(s.Form.Control,{...d.props,required:!0})}),(0,o.tZ)(s.FormButtons,{submitLabel:(0,n.localizationKeys)("userProfile.deletePage.confirm"),colorScheme:"danger",isDisabled:!m})]})})})),Fe=e=>(0,o.BX)(s.ProfileCardContent,{contentRef:e.contentRef,children:[(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(Re,{})}),(0,o.tZ)(c.Route,{path:"profile",children:(0,o.tZ)(Q,{})}),(0,o.tZ)(c.Route,{path:"email-address",children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:":id/remove",children:(0,o.tZ)(G,{})}),(0,o.tZ)(c.Route,{path:":id",children:(0,o.tZ)(K,{})}),(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(K,{})})]})}),(0,o.tZ)(c.Route,{path:"phone-number",children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:":id/remove",children:(0,o.tZ)(J,{})}),(0,o.tZ)(c.Route,{path:":id",children:(0,o.tZ)(F,{})}),(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(F,{})})]})}),(0,o.tZ)(c.Route,{path:"multi-factor",children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:"totp/remove",children:(0,o.tZ)(oe,{})}),(0,o.tZ)(c.Route,{path:"backup_code/add",children:(0,o.tZ)(x,{})}),(0,o.tZ)(c.Route,{path:":id/remove",children:(0,o.tZ)(ie,{})}),(0,o.tZ)(c.Route,{path:":id",children:(0,o.tZ)(O,{})}),(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(O,{})})]})}),(0,o.tZ)(c.Route,{path:"connected-account",children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:":id/remove",children:(0,o.tZ)(ee,{})}),(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(p,{})})]})}),(0,o.tZ)(c.Route,{path:"web3-wallet",children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:":id/remove",children:(0,o.tZ)(te,{})}),(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(Ae,{})})]})}),(0,o.tZ)(c.Route,{path:"username",children:(0,o.tZ)(Te,{})}),(0,o.tZ)(c.Route,{path:"password",children:(0,o.tZ)(V,{})}),(0,o.tZ)(c.Route,{path:"delete",children:(0,o.tZ)(Le,{})})]}),Ne=(0,l.withCoreUserGuard)((()=>{const e=r.useRef(null);return(0,o.tZ)(s.ProfileCard,{sx:{height:"100%"},children:(0,o.tZ)(u.Y,{contentRef:e,children:(0,o.tZ)(Fe,{contentRef:e})})})})),Ue=(0,a.ZP)((0,s.withCardStateProvider)((e=>(0,o.tZ)(n.Flow.Root,{flow:"userProfile",children:(0,o.tZ)(n.Flow.Part,{children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:"verify",children:(0,o.tZ)(C,{})}),(0,o.tZ)(c.Route,{children:(0,o.tZ)(Ne,{})})]})})})))),Xe=e=>{const t={...e,routing:"virtual",componentName:"UserProfile",mode:"modal"};return(0,o.tZ)(c.Route,{path:"user",children:(0,o.tZ)(l.ComponentContext.Provider,{value:t,children:(0,o.tZ)("div",{children:(0,o.tZ)(Ue,{...t})})})})}}}]);